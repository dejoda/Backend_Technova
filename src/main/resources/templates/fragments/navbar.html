<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
</head>
<body>

<nav class="bg-white shadow-lg" th:fragment="navbar">
    <div class="container mx-auto px-4">
        <div class="flex justify-between items-center py-4">

            <a href="/" class="text-2xl font-bold text-blue-600 flex items-center">
                🎮 PeriTech
            </a>


            <div class="hidden md:flex space-x-6">
                <a href="/" class="text-gray-600 hover:text-blue-600 transition duration-300">
                    Inicio
                </a>
                <a href="/productos/tienda" class="text-gray-600 hover:text-blue-600 transition duration-300">
                    Tienda
                </a>
                <a href="/nosotros" class="text-gray-600 hover:text-blue-600 transition duration-300">
                    Nosotros
                </a>
                <a href="/contacto" class="text-gray-600 hover:text-blue-600 transition duration-300">
                    Contacto
                </a>
            </div>


            <div class="flex items-center space-x-4">
                <!-- Carrito -->
                <a href="/carrito" class="text-gray-600 hover:text-blue-600 relative transition duration-300">
                    🛒
                    <span id="cart-count" class="absolute -top-2 -right-2 bg-red-500 text-white rounded-full text-xs w-5 h-5 flex items-center justify-center">
                            0
                        </span>
                </a>


                <div sec:authorize="!isAuthenticated()" class="flex items-center space-x-3">
                    <a href="/auth/login" class="text-gray-600 hover:text-blue-600 transition duration-300">
                        Iniciar Sesión
                    </a>
                    <a href="/auth/registro" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition duration-300">
                        Registrarse
                    </a>
                </div>


                <div sec:authorize="isAuthenticated()" class="flex items-center space-x-4">

                    <div sec:authorize="hasRole('USER')" class="flex items-center space-x-3">
                        <a th:href="@{/user/dashboard}" class="text-gray-600 hover:text-blue-600 transition duration-300">
                            Mi Cuenta
                        </a>
                        <span class="text-gray-500">|</span>
                        <a th:href="@{/pedidos/historial}" class="text-gray-600 hover:text-blue-600 transition duration-300">
                            Mis Pedidos
                        </a>
                    </div>


                    <div sec:authorize="hasRole('ADMIN')" class="flex items-center space-x-3">
                        <a th:href="@{/admin/dashboard}" class="text-green-600 hover:text-green-700 font-semibold transition duration-300">
                            Panel Admin
                        </a>
                        <span class="text-gray-500">|</span>
                        <a th:href="@{/admin/productos}" class="text-gray-600 hover:text-blue-600 transition duration-300">
                            Productos
                        </a>
                        <a th:href="@{/admin/pedidos}" class="text-gray-600 hover:text-blue-600 transition duration-300">
                            Pedidos
                        </a>
                    </div>


                    <div class="flex items-center space-x-2">
                        <span class="text-gray-700" sec:authentication="principal.username"></span>
                        <span class="text-gray-400">|</span>
                        <form th:action="@{/auth/logout}" method="post" class="inline">
                            <button type="submit" class="text-gray-600 hover:text-red-600 transition duration-300">
                                Cerrar Sesión
                            </button>
                        </form>
                    </div>
                </div>
            </div>


            <div class="md:hidden">
                <button id="mobile-menu-button" class="text-gray-600 hover:text-blue-600">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                    </svg>
                </button>
            </div>
        </div>


        <div id="mobile-menu" class="md:hidden hidden py-4 border-t">
            <div class="flex flex-col space-y-3">
                <a href="/" class="text-gray-600 hover:text-blue-600 transition duration-300">Inicio</a>
                <a href="/productos/tienda" class="text-gray-600 hover:text-blue-600 transition duration-300">Tienda</a>
                <a href="/nosotros" class="text-gray-600 hover:text-blue-600 transition duration-300">Nosotros</a>
                <a href="/contacto" class="text-gray-600 hover:text-blue-600 transition duration-300">Contacto</a>

                <div class="border-t pt-3 mt-3">
                    <div sec:authorize="!isAuthenticated()" class="flex flex-col space-y-2">
                        <a href="/auth/login" class="text-gray-600 hover:text-blue-600 transition duration-300">Iniciar Sesión</a>
                        <a href="/auth/registro" class="bg-blue-600 text-white px-4 py-2 rounded-lg text-center hover:bg-blue-700 transition duration-300">Registrarse</a>
                    </div>

                    <div sec:authorize="isAuthenticated()" class="flex flex-col space-y-2">
                        <span class="text-gray-700 font-semibold" sec:authentication="principal.username"></span>
                        <div sec:authorize="hasRole('USER')">
                            <a th:href="@{/user/dashboard}" class="text-gray-600 hover:text-blue-600 transition duration-300">Mi Cuenta</a>
                            <a th:href="@{/pedidos/historial}" class="text-gray-600 hover:text-blue-600 transition duration-300">Mis Pedidos</a>
                        </div>
                        <div sec:authorize="hasRole('ADMIN')">
                            <a th:href="@{/admin/dashboard}" class="text-green-600 hover:text-green-700 transition duration-300">Panel Admin</a>
                            <a th:href="@{/admin/productos}" class="text-gray-600 hover:text-blue-600 transition duration-300">Productos</a>
                            <a th:href="@{/admin/pedidos}" class="text-gray-600 hover:text-blue-600 transition duration-300">Pedidos</a>
                        </div>
                        <form th:action="@{/auth/logout}" method="post" class="inline">
                            <button type="submit" class="text-red-600 hover:text-red-700 transition duration-300 w-full text-left">
                                Cerrar Sesión
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</nav>


<script>
    document.addEventListener('DOMContentLoaded', function() {
        const mobileMenuButton = document.getElementById('mobile-menu-button');
        const mobileMenu = document.getElementById('mobile-menu');

        if (mobileMenuButton && mobileMenu) {
            mobileMenuButton.addEventListener('click', function() {
                mobileMenu.classList.toggle('hidden');
            });
        }
    });
</script>
</body>
</html>